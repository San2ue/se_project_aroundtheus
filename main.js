!function(){"use strict";class e{constructor(e,t,s){this.name=e.name,this.image=e.link,this._cardSelector=t,this._handleZoomImage=s}_setEventListeners(){this._heartBtn.addEventListener("click",()=>{this._heartBtn.classList.toggle("cards__heart_active")}),this._removeBtn.addEventListener("click",()=>{this._cardElement.remove()}),this._cardImageElement.addEventListener("click",()=>{this._handleZoomImage({name:this.name,link:this.image})})}generateCard(){return this._cardElement=document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0),this._heartBtn=this._cardElement.querySelector(".cards__heart"),this._removeBtn=this._cardElement.querySelector(".cards__delete"),this._cardImageElement=this._cardElement.querySelector(".cards__image"),this._cardImageElement.src=this.image,this._cardImageElement.alt=this.name,this._cardElement.querySelector(".cards__title").textContent=this.name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitBtnSelector=e.submitBtnSelector,this._inactiveBtnClass=e.inactiveBtnClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputElements=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElements=this._form.querySelector(this._submitBtnSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(){return!this._inputElements.every(e=>e.validity.valid)}toggleButtonState(){this._hasInvalidInput()?(this._buttonElements.classList.add(this._inactiveBtnClass),this._buttonElements.disabled=!0):(this._buttonElements.classList.remove(this._inactiveBtnClass),this._buttonElements.disabled=!1)}resetValidation(){this.toggleButtonState(),this._inputElements.forEach(e=>{this._hideInputError(e)})}_setEventListeners(){this._inputElements.forEach(e=>{e.addEventListener("input",()=>{this._checkInputValidity(e),this.toggleButtonState()})})}enableValidation(){this._setEventListeners()}}class s{constructor({popupSelector:e}){this._popupSelector=e,this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.querySelector(".modal__close").addEventListener("click",()=>{this.close()}),this._popupElement.addEventListener("mousedown",e=>{e.target.classList.contains("modal_open")&&this.close()})}}class n extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputList=[...this._popupForm.querySelectorAll(".modal__input")],this._submitBtn=this._popupElement.querySelector(".modal__save"),this._submitBtnText=this._submitBtn.textContent}_getInputValues(){const e={};return this._inputList.forEach(t=>{e[t.name]=t.value}),e}close(){this._popupForm.reset(),super.close()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})}renderLoading(e,t="Saving..."){this._submitBtn.textContent=e?t:this._submitBtnText}}const r=document.querySelector(".profile__edit-button"),a=document.querySelector(".profile__add-content"),i=document.querySelector(".profile__avatar-edit-button"),o=document.querySelector("edit-avatar"),l=document.querySelector("#edit-modal"),c=document.forms["edit-form"],d=l.querySelector(".modal__name"),h=l.querySelector(".modal__description"),m=document.forms["add-card"],u=document.querySelector(".cards__list"),_={inputSelector:".modal__input",submitBtnSelector:".modal__save",inactiveBtnClass:"modal__save_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},p=new class{constructor(e,t){this._baseUrl=e,this._headers=t}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}_request(e,t){return fetch(e,t).then(this._handleResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse)}updateProfileInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._handleResponse)}updateProfileAvatar(){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:url})}).then(this._handleResponse)}addCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._handleResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handleResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"5af52474-de0d-4418-ae3a-e40f7fe67743","Content-Type":"application/json"}});p.getAppInfo().then(([e,t])=>{L.setUserInfo({name:e.name,description:e.about}),L.changeAvatar({avatar:e.avatar}),v.renderItems(t)}).catch(console.error);const v=new class{constructor({items:e,renderer:t},s){this._item=e,this._renderer=t,this._classSection=s}renderItems(){this._item.forEach(e=>{this._renderer(e)})}addItem(e){this._classSection.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{v.addItem(E(e))}},u);function E(t){return new e(t,"#card__template",b).generateCard()}const g=new n("#edit-modal",function(e){g.renderLoading(!0),p.updateProfileInfo({name:e.name,description:e.description}).then(e=>{L.setUserInfo({name:e.name,description:e.about}),g.close(),console.log(profiledata)}).catch(console.error).finally(()=>{g.renderLoading(!1)})});g.setEventListeners();const f=new n("#avatar-modal",function(e){f.renderLoading(!0),p.updateProfileAvatar(e.link).then(e=>{L.changeAvatarPicture(res),f.close}).catch(console.error).finally(()=>{f.renderLoading(!1)})});f.setEventListeners();const S=new n("#add-modal",function(e){S.renderLoading(!0),p.addCard({name:e.Title,link:e.url}).then(e=>{v.addItem(E(e)),S.close(),C.resetValidation(),console.log(e)}).catch(console.error).finally(()=>{S.renderLoading(!1)})});S.setEventListeners();const y=new class extends s{constructor(e){super({popupSelector:e}),this._previewImage=this._popupElement.querySelector("#modal-image"),this._previewImageTitle=this._popupElement.querySelector("#modal-image-title")}open({name:e,link:t}){this._previewImage.src=t,this._previewImage.alt=e,this._previewImageTitle.textContent=e,super.open()}}("#picture-modal");y.setEventListeners();const L=new class{constructor({name:e,description:t,avatar:s}){this._name=document.querySelector(e),this._description=document.querySelector(t),this._avatar=document.querySelector(s)}changeAvatarPicture(e){this._avatar.src=e}getUserInfo(){return{name:this._name.textContent,description:this._description.textContent}}setUserInfo({name:e,description:t}){this._name.textContent=e,this._description.textContent=t}}({name:".profile__name",description:".profile__description",avatar:".avatar__picture"});function b({name:e,link:t}){y.open({name:e,link:t})}r.addEventListener("click",()=>{const e=L.getUserInfo();d.value=e.name,h.value=e.description,g.open(),I.resetValidation()}),a.addEventListener("click",()=>{S.open(),C.toggleButtonState()}),i.addEventListener("click",()=>{f.open(),w.toggleButtonState()});const I=new t(_,c),C=new t(_,m),w=new t(_,o);I.enableValidation(),C.enableValidation(),w.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzVCekgsS0FBTSxpQkFDTnlILFlBQWEsd0JBQ2JPLE9BQVEscUJBTVYsU0FBU2xJLEdBQWdCLEtBQUVFLEVBQUksS0FBRUUsSUFDL0JzSyxFQUFldkcsS0FBSyxDQUFFakUsT0FBTUUsUUFDOUIsQ0FvRUF3RixFQUFlbkYsaUJBQWlCLFFBQVMsS0FDdkMsTUFBTXVLLEVBQVluQyxFQUFTckIsY0FDM0JyQixFQUFVYixNQUFRMEYsRUFBVTlLLEtBQzVCa0csRUFBaUJkLE1BQVEwRixFQUFVckQsWUFDbkNzQyxFQUFpQjlGLE9BQ2pCOEcsRUFBa0JySCxvQkFHcEJpQyxFQUFjcEYsaUJBQWlCLFFBQVMsS0FDdEM4SixFQUFhcEcsT0FDYnNHLEVBQWtCL0csc0JBR3BCb0MsRUFBY3JGLGlCQUFpQixRQUFTLEtBQ3RDNEosRUFBa0JsRyxPQUNsQitHLEVBQW9CeEgsc0JBSXRCLE1BQU11SCxFQUFvQixJQUFJeEosRUFBYzhFLEVBQVFOLEdBRTlDd0UsRUFBb0IsSUFBSWhKLEVBQWM4RSxFQUFRRixHQUU5QzZFLEVBQXNCLElBQUl6SixFQUFjOEUsRUFBUVIsR0FFdERrRixFQUFrQm5ILG1CQUNsQjJHLEVBQWtCM0csbUJBQ2xCb0gsRUFBb0JwSCxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9BUEkuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvL2NvbnN0IHpvb21JbWFnZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX3pvb21cIik7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZVpvb21JbWFnZSkge1xyXG4gICAgdGhpcy5uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5pbWFnZSA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZVpvb21JbWFnZSA9IGhhbmRsZVpvb21JbWFnZTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2hlYXJ0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hlYXJ0QnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkc19faGVhcnRfYWN0aXZlXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fcmVtb3ZlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVab29tSW1hZ2UoeyBuYW1lOiB0aGlzLm5hbWUsIGxpbms6IHRoaXMuaW1hZ2UgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgdGhpcy5faGVhcnRCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19oZWFydFwiKTtcclxuICAgIHRoaXMuX3JlbW92ZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2RlbGV0ZVwiKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuaW1hZ2U7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMubmFtZTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5uYW1lO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9wdGlvbnMuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0blNlbGVjdG9yID0gb3B0aW9ucy5zdWJtaXRCdG5TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnRuQ2xhc3MgPSBvcHRpb25zLmluYWN0aXZlQnRuQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBvcHRpb25zLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBvcHRpb25zLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnRzID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ0blNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yTXNnRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudHMpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50cy52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50cyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnRzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkoXHJcbiAgICAgIChpbnB1dEVsZW1lbnRzKSA9PiBpbnB1dEVsZW1lbnRzLnZhbGlkaXR5LnZhbGlkXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudHMuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ0bkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudHMuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudHMuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ0bkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudHMuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yID0gcG9wdXBTZWxlY3RvcjtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICAgIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgZm9ybVZhbHVlc1tpbnB1dEVsZW1lbnQubmFtZV0gPSBpbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8vIEVsZW1lbnRzXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtY29udGVudFwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2F2YXRhci1lZGl0LWJ1dHRvblwiLFxyXG4pO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJlZGl0LWF2YXRhclwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtZm9ybVwiXTtcclxuZXhwb3J0IGNvbnN0IG1vZGFsTmFtZSA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fbmFtZVwiKTtcclxuZXhwb3J0IGNvbnN0IG1vZGFsRGVzY3JpcHRpb24gPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2Rlc2NyaXB0aW9uXCIsXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgYWRkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmRcIl07XHJcblxyXG5leHBvcnQgY29uc3QgY2FyZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdG5TZWxlY3RvcjogXCIubW9kYWxfX3NhdmVcIixcclxuICBpbmFjdGl2ZUJ0bkNsYXNzOiBcIm1vZGFsX19zYXZlX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQVBJIGZyb20gXCIuLi9jb21wb25lbnRzL0FQSS5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHtcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgcHJvZmlsZUVkaXRCdG4sXHJcbiAgcHJvZmlsZUFkZEJ0bixcclxuICBhdmF0YXJFZGl0QnRuLFxyXG4gIHByb2ZpbGVGb3JtLFxyXG4gIGF2YXRhckZvcm0sXHJcbiAgbW9kYWxOYW1lLFxyXG4gIG1vZGFsRGVzY3JpcHRpb24sXHJcbiAgYWRkRm9ybSxcclxuICBjYXJkTGlzdCxcclxuICBjb25maWcsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuLy9pbXBvcnRzXHJcbmNvbnN0IGFwaSA9IG5ldyBBUEkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjVhZjUyNDc0LWRlMGQtNDQxOC1hZTNhLWU0MGY3ZmU2Nzc0M1wiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5hYm91dCxcclxuICAgIH0pO1xyXG4gICAgdXNlckluZm8uY2hhbmdlQXZhdGFyKHsgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIgfSk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG4vL1NlY3Rpb25cclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oZ2V0Q2FyZEVsZW1lbnQoZGF0YSkpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIGNhcmRMaXN0LFxyXG4pO1xyXG4vL2NhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcblxyXG4vL25ldyBDYXJkXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoRGF0YSwgXCIjY2FyZF9fdGVtcGxhdGVcIiwgaGFuZGxlWm9vbUltYWdlKTtcclxuXHJcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcbi8vRWRpdCBQcm9maWxlIFBvcHVwXHJcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNlZGl0LW1vZGFsXCIsIHNhdmVQcm9maWxlKTtcclxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9FZGl0IEF2YXRhciBQb3B1cFxyXG5jb25zdCBjaGFuZ2VBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2F2YXRhci1tb2RhbFwiLCBjaGFuZ2VBdmF0YXIpO1xyXG5jaGFuZ2VBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9BZGQgTmV3IENhcmQgUG9wdXBcclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLW1vZGFsXCIsIHNhdmVDYXJkcyk7XHJcbm5ld0NhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9QcmV2aWV3IEltYWdlXHJcbmNvbnN0IHByZXZpZXdQaWN0dXJlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3BpY3R1cmUtbW9kYWxcIik7XHJcbnByZXZpZXdQaWN0dXJlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL1VzZXJJbmZvXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lOiBcIi5wcm9maWxlX19uYW1lXCIsXHJcbiAgZGVzY3JpcHRpb246IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgYXZhdGFyOiBcIi5hdmF0YXJfX3BpY3R1cmVcIixcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbnNcclxuXHJcbi8vQ2FyZCBJbWFnZSBab29tXHJcbmZ1bmN0aW9uIGhhbmRsZVpvb21JbWFnZSh7IG5hbWUsIGxpbmsgfSkge1xyXG4gIHByZXZpZXdQaWN0dXJlLm9wZW4oeyBuYW1lLCBsaW5rIH0pO1xyXG59XHJcblxyXG4vKmZ1bmN0aW9uIHNhdmVQcm9maWxlKHByb2ZpbGVkYXRhKSB7XHJcbiAgY29uc3QgbmFtZSA9IHByb2ZpbGVkYXRhLm5hbWU7XHJcbiAgY29uc3QgZGVzY3JpcHRpb24gPSBwcm9maWxlZGF0YS5kZXNjcmlwdGlvbjtcclxuICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pO1xyXG4gIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuICBjb25zb2xlLmxvZyhwcm9maWxlZGF0YSk7XHJcbn0gKi9cclxuLy9TYXZlIFByb2ZpbGUgSW5mb1xyXG5mdW5jdGlvbiBzYXZlUHJvZmlsZShkYXRhKSB7XHJcbiAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVByb2ZpbGVJbmZvKHsgbmFtZTogZGF0YS5uYW1lLCBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiBkYXRhLm5hbWUsIGRlc2NyaXB0aW9uOiBkYXRhLmFib3V0IH0pO1xyXG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKHByb2ZpbGVkYXRhKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vKmZ1bmN0aW9uIHNhdmVDYXJkcyhkYXRhKSB7XHJcbiAgY29uc3QgbmFtZSA9IGRhdGEuVGl0bGU7XHJcbiAgY29uc3QgbGluayA9IGRhdGEudXJsO1xyXG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0oZ2V0Q2FyZEVsZW1lbnQoeyBuYW1lLCBsaW5rIH0pKTtcclxuICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcclxuICBjYXJkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBjb25zb2xlLmxvZyhkYXRhKTtcclxufSovXHJcblxyXG4vL0FkZCBOZXcgQ2FyZFxyXG5mdW5jdGlvbiBzYXZlQ2FyZHMoZGF0YSkge1xyXG4gIG5ld0NhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoeyBuYW1lOiBkYXRhLlRpdGxlLCBsaW5rOiBkYXRhLnVybCB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShnZXRDYXJkRWxlbWVudChkYXRhKSk7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICBjYXJkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vL0NoYW5nZSBBdmF0YXJcclxuZnVuY3Rpb24gY2hhbmdlQXZhdGFyKGRhdGEpIHtcclxuICBjaGFuZ2VBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVByb2ZpbGVBdmF0YXIoZGF0YS5saW5rKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgdXNlckluZm8uY2hhbmdlQXZhdGFyUGljdHVyZShyZXMpO1xyXG4gICAgICBjaGFuZ2VBdmF0YXJQb3B1cC5jbG9zZTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgY2hhbmdlQXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gTGlzdGVuZXJzXHJcblxyXG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHVzZXJJbnB1dCA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgbW9kYWxOYW1lLnZhbHVlID0gdXNlcklucHV0Lm5hbWU7XHJcbiAgbW9kYWxEZXNjcmlwdGlvbi52YWx1ZSA9IHVzZXJJbnB1dC5kZXNjcmlwdGlvbjtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5wcm9maWxlQWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcclxuICBjYXJkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG59KTtcclxuXHJcbmF2YXRhckVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjaGFuZ2VBdmF0YXJQb3B1cC5vcGVuKCk7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG59KTtcclxuXHJcbi8vdmFsaWRhdG9yc1xyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUZvcm0pO1xyXG5cclxuY29uc3QgY2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGFkZEZvcm0pO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYXZhdGFyRm9ybSk7XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmNhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoYmFzZVVybCwgaGVhZGVycykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQcm9maWxlSW5mbyhuYW1lLCBkZXNjcmlwdGlvbikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGRlc2NyaXB0aW9uLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZUF2YXRhcigpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiB1cmwsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKG5hbWUsIGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY2xhc3NTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbSA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NsYXNzU2VjdGlvbiA9IGNsYXNzU2VsZWN0b3I7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW0uZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jbGFzc1NlY3Rpb24ucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1pbWFnZVwiKTtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZVRpdGxlID1cclxuICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW1hZ2UtdGl0bGVcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBkZXNjcmlwdGlvbiwgYXZhdGFyIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uKTtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyKTtcclxuICB9XHJcblxyXG4gIGNoYW5nZUF2YXRhclBpY3R1cmUoYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlWm9vbUltYWdlIiwidGhpcyIsIm5hbWUiLCJpbWFnZSIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZVpvb21JbWFnZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9oZWFydEJ0biIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfcmVtb3ZlQnRuIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJnZW5lcmF0ZUNhcmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJvcHRpb25zIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnRuU2VsZWN0b3IiLCJzdWJtaXRCdG5TZWxlY3RvciIsIl9pbmFjdGl2ZUJ0bkNsYXNzIiwiaW5hY3RpdmVCdG5DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9pbnB1dEVsZW1lbnRzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50cyIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTXNnRWxlbWVudCIsImlkIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiaW5wdXRFbGVtZW50cyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiZXZlcnkiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVkIiwicmVzZXRWYWxpZGF0aW9uIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwiX3N1Ym1pdEJ0biIsIl9zdWJtaXRCdG5UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsInZhbHVlIiwicmVzZXQiLCJwcmV2ZW50RGVmYXVsdCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsInByb2ZpbGVFZGl0QnRuIiwicHJvZmlsZUFkZEJ0biIsImF2YXRhckVkaXRCdG4iLCJhdmF0YXJGb3JtIiwiZWRpdFByb2ZpbGVNb2RhbCIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJtb2RhbE5hbWUiLCJtb2RhbERlc2NyaXB0aW9uIiwiYWRkRm9ybSIsImNhcmRMaXN0IiwiY29uZmlnIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVJlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsIl9yZXF1ZXN0IiwidXJsIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJ1cGRhdGVQcm9maWxlSW5mbyIsImRlc2NyaXB0aW9uIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsInVwZGF0ZVByb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJhZGRDYXJkIiwibGlrZUNhcmQiLCJjYXJkSWQiLCJ1bmxpa2VDYXJkIiwiZGVsZXRlQ2FyZCIsImdldEFwcEluZm8iLCJhbGwiLCJhdXRob3JpemF0aW9uIiwidXNlckRhdGEiLCJjYXJkcyIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJjaGFuZ2VBdmF0YXIiLCJjYXJkU2VjdGlvbiIsInJlbmRlckl0ZW1zIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiY2xhc3NTZWxlY3RvciIsIl9pdGVtIiwiX3JlbmRlcmVyIiwiX2NsYXNzU2VjdGlvbiIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJnZXRDYXJkRWxlbWVudCIsIkRhdGEiLCJlZGl0UHJvZmlsZVBvcHVwIiwibG9nIiwicHJvZmlsZWRhdGEiLCJmaW5hbGx5IiwiY2hhbmdlQXZhdGFyUG9wdXAiLCJjaGFuZ2VBdmF0YXJQaWN0dXJlIiwibmV3Q2FyZFBvcHVwIiwiVGl0bGUiLCJjYXJkRm9ybVZhbGlkYXRvciIsInByZXZpZXdQaWN0dXJlIiwiX3ByZXZpZXdJbWFnZSIsIl9wcmV2aWV3SW1hZ2VUaXRsZSIsIl9uYW1lIiwiX2Rlc2NyaXB0aW9uIiwiX2F2YXRhciIsInVzZXJJbnB1dCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=